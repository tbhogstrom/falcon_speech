import _styled from "@emotion/styled/base";
import _isEqual from "lodash/isEqual";
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
function _EMOTION_STRINGIFIED_CSS_ERROR__() { return "You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."; }
// @refresh reset
import React, { useCallback, useEffect, useMemo, useState } from 'react';
import PropTypes from 'prop-types';
import ImmutablePropTypes from 'react-immutable-proptypes';
import { ClassNames, css as coreCss } from '@emotion/react';
import { lengths, fonts, zIndex } from 'decap-cms-ui-default';
import { createEditor, Transforms, Editor as SlateEditor } from 'slate';
import { Editable, ReactEditor, Slate, withReact } from 'slate-react';
import { withHistory } from 'slate-history';
import { fromJS } from 'immutable';
import { editorStyleVars, EditorControlBar } from '../styles';
import Toolbar from './Toolbar';
import { Element, Leaf } from './renderers';
import withLists from './plugins/lists/withLists';
import withBlocks from './plugins/blocks/withBlocks';
import withInlines from './plugins/inlines/withInlines';
import toggleMark from './plugins/inlines/events/toggleMark';
import toggleLink from './plugins/inlines/events/toggleLink';
import getActiveLink from './plugins/inlines/selectors/getActiveLink';
import isMarkActive from './plugins/inlines/locations/isMarkActive';
import isCursorInBlockType from './plugins/blocks/locations/isCursorInBlockType';
import { markdownToSlate, slateToMarkdown } from '../serializers';
import withShortcodes from './plugins/shortcodes/withShortcodes';
import insertShortcode from './plugins/shortcodes/insertShortcode';
import defaultEmptyBlock from './plugins/blocks/defaultEmptyBlock';
import withHtml from './plugins/html/withHtml';
import { jsx as ___EmotionJSX } from "@emotion/react";
function visualEditorStyles({
  minimal
}) {
  return `
  position: relative;
  overflow: auto;
  font-family: ${fonts.primary};
  min-height: ${minimal ? 'auto' : lengths.richTextEditorMinHeight};
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  border-top: 0;
  margin-top: -${editorStyleVars.stickyDistanceBottom};
  padding: 0;
  display: flex;
  flex-direction: column;
  z-index: ${zIndex.zIndex100};
`;
}
const InsertionPoint = /*#__PURE__*/_styled("div", {
  target: "ebiot7z0",
  label: "InsertionPoint"
})(process.env.NODE_ENV === "production" ? {
  name: "ma7xbc",
  styles: "flex:1 1 auto;cursor:text"
} : {
  name: "ma7xbc",
  styles: "flex:1 1 auto;cursor:text",
  map: "/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9NYXJrZG93bkNvbnRyb2wvVmlzdWFsRWRpdG9yLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQStDaUMiLCJmaWxlIjoiLi4vLi4vLi4vc3JjL01hcmtkb3duQ29udHJvbC9WaXN1YWxFZGl0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAcmVmcmVzaCByZXNldFxuaW1wb3J0IFJlYWN0LCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBJbW11dGFibGVQcm9wVHlwZXMgZnJvbSAncmVhY3QtaW1tdXRhYmxlLXByb3B0eXBlcyc7XG5pbXBvcnQgeyBDbGFzc05hbWVzLCBjc3MgYXMgY29yZUNzcyB9IGZyb20gJ0BlbW90aW9uL3JlYWN0JztcbmltcG9ydCB7IGxlbmd0aHMsIGZvbnRzLCB6SW5kZXggfSBmcm9tICdkZWNhcC1jbXMtdWktZGVmYXVsdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBjcmVhdGVFZGl0b3IsIFRyYW5zZm9ybXMsIEVkaXRvciBhcyBTbGF0ZUVkaXRvciB9IGZyb20gJ3NsYXRlJztcbmltcG9ydCB7IEVkaXRhYmxlLCBSZWFjdEVkaXRvciwgU2xhdGUsIHdpdGhSZWFjdCB9IGZyb20gJ3NsYXRlLXJlYWN0JztcbmltcG9ydCB7IHdpdGhIaXN0b3J5IH0gZnJvbSAnc2xhdGUtaGlzdG9yeSc7XG5pbXBvcnQgeyBmcm9tSlMgfSBmcm9tICdpbW11dGFibGUnO1xuaW1wb3J0IHsgaXNFcXVhbCB9IGZyb20gJ2xvZGFzaCc7XG5cbmltcG9ydCB7IGVkaXRvclN0eWxlVmFycywgRWRpdG9yQ29udHJvbEJhciB9IGZyb20gJy4uL3N0eWxlcyc7XG5pbXBvcnQgVG9vbGJhciBmcm9tICcuL1Rvb2xiYXInO1xuaW1wb3J0IHsgRWxlbWVudCwgTGVhZiB9IGZyb20gJy4vcmVuZGVyZXJzJztcbmltcG9ydCB3aXRoTGlzdHMgZnJvbSAnLi9wbHVnaW5zL2xpc3RzL3dpdGhMaXN0cyc7XG5pbXBvcnQgd2l0aEJsb2NrcyBmcm9tICcuL3BsdWdpbnMvYmxvY2tzL3dpdGhCbG9ja3MnO1xuaW1wb3J0IHdpdGhJbmxpbmVzIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL3dpdGhJbmxpbmVzJztcbmltcG9ydCB0b2dnbGVNYXJrIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL2V2ZW50cy90b2dnbGVNYXJrJztcbmltcG9ydCB0b2dnbGVMaW5rIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL2V2ZW50cy90b2dnbGVMaW5rJztcbmltcG9ydCBnZXRBY3RpdmVMaW5rIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL3NlbGVjdG9ycy9nZXRBY3RpdmVMaW5rJztcbmltcG9ydCBpc01hcmtBY3RpdmUgZnJvbSAnLi9wbHVnaW5zL2lubGluZXMvbG9jYXRpb25zL2lzTWFya0FjdGl2ZSc7XG5pbXBvcnQgaXNDdXJzb3JJbkJsb2NrVHlwZSBmcm9tICcuL3BsdWdpbnMvYmxvY2tzL2xvY2F0aW9ucy9pc0N1cnNvckluQmxvY2tUeXBlJztcbmltcG9ydCB7IG1hcmtkb3duVG9TbGF0ZSwgc2xhdGVUb01hcmtkb3duIH0gZnJvbSAnLi4vc2VyaWFsaXplcnMnO1xuaW1wb3J0IHdpdGhTaG9ydGNvZGVzIGZyb20gJy4vcGx1Z2lucy9zaG9ydGNvZGVzL3dpdGhTaG9ydGNvZGVzJztcbmltcG9ydCBpbnNlcnRTaG9ydGNvZGUgZnJvbSAnLi9wbHVnaW5zL3Nob3J0Y29kZXMvaW5zZXJ0U2hvcnRjb2RlJztcbmltcG9ydCBkZWZhdWx0RW1wdHlCbG9jayBmcm9tICcuL3BsdWdpbnMvYmxvY2tzL2RlZmF1bHRFbXB0eUJsb2NrJztcbmltcG9ydCB3aXRoSHRtbCBmcm9tICcuL3BsdWdpbnMvaHRtbC93aXRoSHRtbCc7XG5cbmZ1bmN0aW9uIHZpc3VhbEVkaXRvclN0eWxlcyh7IG1pbmltYWwgfSkge1xuICByZXR1cm4gYFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIG92ZXJmbG93OiBhdXRvO1xuICBmb250LWZhbWlseTogJHtmb250cy5wcmltYXJ5fTtcbiAgbWluLWhlaWdodDogJHttaW5pbWFsID8gJ2F1dG8nIDogbGVuZ3Rocy5yaWNoVGV4dEVkaXRvck1pbkhlaWdodH07XG4gIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDA7XG4gIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAwO1xuICBib3JkZXItdG9wOiAwO1xuICBtYXJnaW4tdG9wOiAtJHtlZGl0b3JTdHlsZVZhcnMuc3RpY2t5RGlzdGFuY2VCb3R0b219O1xuICBwYWRkaW5nOiAwO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICB6LWluZGV4OiAke3pJbmRleC56SW5kZXgxMDB9O1xuYDtcbn1cblxuY29uc3QgSW5zZXJ0aW9uUG9pbnQgPSBzdHlsZWQuZGl2YFxuICBmbGV4OiAxIDEgYXV0bztcbiAgY3Vyc29yOiB0ZXh0O1xuYDtcblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlTWVkaWFDb25maWcoZWRpdG9yQ29tcG9uZW50cywgZmllbGQpIHtcbiAgLy8gbWVyZ2UgZWRpdG9yIG1lZGlhIGxpYnJhcnkgY29uZmlnIHRvIGltYWdlIGNvbXBvbmVudHNcbiAgaWYgKGVkaXRvckNvbXBvbmVudHMuaGFzKCdpbWFnZScpKSB7XG4gICAgY29uc3QgaW1hZ2VDb21wb25lbnQgPSBlZGl0b3JDb21wb25lbnRzLmdldCgnaW1hZ2UnKTtcbiAgICBjb25zdCBmaWVsZHMgPSBpbWFnZUNvbXBvbmVudD8uZmllbGRzO1xuXG4gICAgaWYgKGZpZWxkcykge1xuICAgICAgaW1hZ2VDb21wb25lbnQuZmllbGRzID0gZmllbGRzLnVwZGF0ZShcbiAgICAgICAgZmllbGRzLmZpbmRJbmRleChmID0+IGYuZ2V0KCd3aWRnZXQnKSA9PT0gJ2ltYWdlJyksXG4gICAgICAgIGYgPT4ge1xuICAgICAgICAgIC8vIG1lcmdlIGBtZWRpYV9saWJyYXJ5YCBjb25maWdcbiAgICAgICAgICBpZiAoZmllbGQuaGFzKCdtZWRpYV9saWJyYXJ5JykpIHtcbiAgICAgICAgICAgIGYgPSBmLnNldChcbiAgICAgICAgICAgICAgJ21lZGlhX2xpYnJhcnknLFxuICAgICAgICAgICAgICBmaWVsZC5nZXQoJ21lZGlhX2xpYnJhcnknKS5tZXJnZURlZXAoZi5nZXQoJ21lZGlhX2xpYnJhcnknKSksXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBtZXJnZSAnbWVkaWFfZm9sZGVyJ1xuICAgICAgICAgIGlmIChmaWVsZC5oYXMoJ21lZGlhX2ZvbGRlcicpICYmICFmLmhhcygnbWVkaWFfZm9sZGVyJykpIHtcbiAgICAgICAgICAgIGYgPSBmLnNldCgnbWVkaWFfZm9sZGVyJywgZmllbGQuZ2V0KCdtZWRpYV9mb2xkZXInKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIG1lcmdlICdwdWJsaWNfZm9sZGVyJ1xuICAgICAgICAgIGlmIChmaWVsZC5oYXMoJ3B1YmxpY19mb2xkZXInKSAmJiAhZi5oYXMoJ3B1YmxpY19mb2xkZXInKSkge1xuICAgICAgICAgICAgZiA9IGYuc2V0KCdwdWJsaWNfZm9sZGVyJywgZmllbGQuZ2V0KCdwdWJsaWNfZm9sZGVyJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZjtcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIEVkaXRvcihwcm9wcykge1xuICBjb25zdCB7XG4gICAgb25BZGRBc3NldCxcbiAgICBnZXRBc3NldCxcbiAgICBjbGFzc05hbWUsXG4gICAgZmllbGQsXG4gICAgaXNTaG93TW9kZVRvZ2dsZSxcbiAgICB0LFxuICAgIGlzRGlzYWJsZWQsXG4gICAgZ2V0RWRpdG9yQ29tcG9uZW50cyxcbiAgICBnZXRSZW1hcmtQbHVnaW5zLFxuICAgIG9uQ2hhbmdlLFxuICB9ID0gcHJvcHM7XG5cbiAgY29uc3QgZWRpdG9yID0gdXNlTWVtbyhcbiAgICAoKSA9PlxuICAgICAgd2l0aEh0bWwoXG4gICAgICAgIHdpdGhSZWFjdCh3aXRoSGlzdG9yeSh3aXRoU2hvcnRjb2Rlcyh3aXRoQmxvY2tzKHdpdGhMaXN0cyh3aXRoSW5saW5lcyhjcmVhdGVFZGl0b3IoKSkpKSkpKSxcbiAgICAgICksXG4gICAgW10sXG4gICk7XG5cbiAgY29uc3QgZW1wdHlWYWx1ZSA9IFtkZWZhdWx0RW1wdHlCbG9jaygpXTtcbiAgbGV0IGVkaXRvckNvbXBvbmVudHMgPSBnZXRFZGl0b3JDb21wb25lbnRzKCk7XG4gIGNvbnN0IGNvZGVCbG9ja0NvbXBvbmVudCA9IGZyb21KUyhlZGl0b3JDb21wb25lbnRzLmZpbmQoKHsgdHlwZSB9KSA9PiB0eXBlID09PSAnY29kZS1ibG9jaycpKTtcblxuICBlZGl0b3JDb21wb25lbnRzID1cbiAgICBjb2RlQmxvY2tDb21wb25lbnQgfHwgZWRpdG9yQ29tcG9uZW50cy5oYXMoJ2NvZGUtYmxvY2snKVxuICAgICAgPyBlZGl0b3JDb21wb25lbnRzXG4gICAgICA6IGVkaXRvckNvbXBvbmVudHMuc2V0KCdjb2RlLWJsb2NrJywgeyBsYWJlbDogJ0NvZGUgQmxvY2snLCB0eXBlOiAnY29kZS1ibG9jaycgfSk7XG5cbiAgbWVyZ2VNZWRpYUNvbmZpZyhlZGl0b3JDb21wb25lbnRzLCBmaWVsZCk7XG5cbiAgY29uc3QgW2VkaXRvclZhbHVlLCBzZXRFZGl0b3JWYWx1ZV0gPSB1c2VTdGF0ZShcbiAgICBwcm9wcy52YWx1ZVxuICAgICAgPyBtYXJrZG93blRvU2xhdGUocHJvcHMudmFsdWUsIHtcbiAgICAgICAgICB2b2lkQ29kZUJsb2NrOiAhIWNvZGVCbG9ja0NvbXBvbmVudCxcbiAgICAgICAgICByZW1hcmtQbHVnaW5zOiBnZXRSZW1hcmtQbHVnaW5zKCksXG4gICAgICAgIH0pXG4gICAgICA6IGVtcHR5VmFsdWUsXG4gICk7XG5cbiAgY29uc3QgcmVuZGVyRWxlbWVudCA9IHVzZUNhbGxiYWNrKFxuICAgIHByb3BzID0+IChcbiAgICAgIDxFbGVtZW50IHsuLi5wcm9wc30gY2xhc3NOYW1lV3JhcHBlcj17Y2xhc3NOYW1lfSBjb2RlQmxvY2tDb21wb25lbnQ9e2NvZGVCbG9ja0NvbXBvbmVudH0gLz5cbiAgICApLFxuICAgIFtdLFxuICApO1xuICBjb25zdCByZW5kZXJMZWFmID0gdXNlQ2FsbGJhY2socHJvcHMgPT4gPExlYWYgey4uLnByb3BzfSAvPiwgW10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHByb3BzLnBlbmRpbmdGb2N1cykge1xuICAgICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICAgIHByb3BzLnBlbmRpbmdGb2N1cygpO1xuICAgIH1cbiAgfSwgW3Byb3BzLnBlbmRpbmdGb2N1c10pO1xuXG4gIGZ1bmN0aW9uIGhhbmRsZU1hcmtDbGljayhmb3JtYXQpIHtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICAgIHRvZ2dsZU1hcmsoZWRpdG9yLCBmb3JtYXQpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlQmxvY2tDbGljayhmb3JtYXQpIHtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICAgIGlmIChmb3JtYXQuZW5kc1dpdGgoJy1saXN0JykpIHtcbiAgICAgIGVkaXRvci50b2dnbGVMaXN0KGZvcm1hdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVkaXRvci50b2dnbGVCbG9jayhmb3JtYXQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUxpbmtDbGljaygpIHtcbiAgICB0b2dnbGVMaW5rKGVkaXRvciwgdCgnZWRpdG9yLmVkaXRvcldpZGdldHMubWFya2Rvd24ubGlua1Byb21wdCcpKTtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlVG9nZ2xlTW9kZSgpIHtcbiAgICBwcm9wcy5vbk1vZGUoJ3JhdycpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlSW5zZXJ0U2hvcnRjb2RlKHBsdWdpbkNvbmZpZykge1xuICAgIGluc2VydFNob3J0Y29kZShlZGl0b3IsIHBsdWdpbkNvbmZpZyk7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVLZXlEb3duKGV2ZW50KSB7XG4gICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGVkaXRvci5rZXlEb3duSGFuZGxlcnMgfHwgW10pIHtcbiAgICAgIGlmIChoYW5kbGVyKGV2ZW50LCBlZGl0b3IpID09PSBmYWxzZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUNsaWNrQmVsb3dEb2N1bWVudCgpIHtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICAgIFRyYW5zZm9ybXMuc2VsZWN0KGVkaXRvciwgeyBwYXRoOiBbMCwgMF0sIG9mZnNldDogMCB9KTtcbiAgICBUcmFuc2Zvcm1zLnNlbGVjdChlZGl0b3IsIFNsYXRlRWRpdG9yLmVuZChlZGl0b3IsIFtdKSk7XG4gIH1cbiAgY29uc3QgW3Rvb2xiYXJLZXksIHNldFRvb2xiYXJLZXldID0gdXNlU3RhdGUoMCk7XG5cbiAgZnVuY3Rpb24gaGFuZGxlQ2hhbmdlKG5ld1ZhbHVlKSB7XG4gICAgaWYgKCFpc0VxdWFsKG5ld1ZhbHVlLCBlZGl0b3JWYWx1ZSkpIHtcbiAgICAgIHNldEVkaXRvclZhbHVlKCgpID0+IG5ld1ZhbHVlKTtcbiAgICAgIG9uQ2hhbmdlKFxuICAgICAgICBzbGF0ZVRvTWFya2Rvd24obmV3VmFsdWUsIHtcbiAgICAgICAgICB2b2lkQ29kZUJsb2NrOiAhIWNvZGVCbG9ja0NvbXBvbmVudCxcbiAgICAgICAgICByZW1hcmtQbHVnaW5zOiBnZXRSZW1hcmtQbHVnaW5zKCksXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9XG4gICAgc2V0VG9vbGJhcktleShwcmV2ID0+IHByZXYgKyAxKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhc01hcmsoZm9ybWF0KSB7XG4gICAgcmV0dXJuIGlzTWFya0FjdGl2ZShlZGl0b3IsIGZvcm1hdCk7XG4gIH1cblxuICBmdW5jdGlvbiBoYXNJbmxpbmUoZm9ybWF0KSB7XG4gICAgaWYgKGZvcm1hdCA9PSAnbGluaycpIHtcbiAgICAgIHJldHVybiAhIWdldEFjdGl2ZUxpbmsoZWRpdG9yKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFzQmxvY2soZm9ybWF0KSB7XG4gICAgcmV0dXJuIGlzQ3Vyc29ySW5CbG9ja1R5cGUoZWRpdG9yLCBmb3JtYXQpO1xuICB9XG4gIGZ1bmN0aW9uIGhhc1F1b3RlKCkge1xuICAgIHJldHVybiBpc0N1cnNvckluQmxvY2tUeXBlKGVkaXRvciwgJ3F1b3RlJyk7XG4gIH1cbiAgZnVuY3Rpb24gaGFzTGlzdEl0ZW1zKHR5cGUpIHtcbiAgICByZXR1cm4gaXNDdXJzb3JJbkJsb2NrVHlwZShlZGl0b3IsIHR5cGUpO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjc3M9e2NvcmVDc3NgXG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIGB9XG4gICAgPlxuICAgICAgPFNsYXRlIGVkaXRvcj17ZWRpdG9yfSB2YWx1ZT17ZWRpdG9yVmFsdWV9IG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9PlxuICAgICAgICA8RWRpdG9yQ29udHJvbEJhcj5cbiAgICAgICAgICB7XG4gICAgICAgICAgICA8VG9vbGJhclxuICAgICAgICAgICAgICBrZXk9e3Rvb2xiYXJLZXl9XG4gICAgICAgICAgICAgIG9uTWFya0NsaWNrPXtoYW5kbGVNYXJrQ2xpY2t9XG4gICAgICAgICAgICAgIG9uQmxvY2tDbGljaz17aGFuZGxlQmxvY2tDbGlja31cbiAgICAgICAgICAgICAgb25MaW5rQ2xpY2s9e2hhbmRsZUxpbmtDbGlja31cbiAgICAgICAgICAgICAgb25Ub2dnbGVNb2RlPXtoYW5kbGVUb2dnbGVNb2RlfVxuICAgICAgICAgICAgICBwbHVnaW5zPXtlZGl0b3JDb21wb25lbnRzfVxuICAgICAgICAgICAgICBvblN1Ym1pdD17aGFuZGxlSW5zZXJ0U2hvcnRjb2RlfVxuICAgICAgICAgICAgICBvbkFkZEFzc2V0PXtvbkFkZEFzc2V0fVxuICAgICAgICAgICAgICBnZXRBc3NldD17Z2V0QXNzZXR9XG4gICAgICAgICAgICAgIGJ1dHRvbnM9e2ZpZWxkLmdldCgnYnV0dG9ucycpfVxuICAgICAgICAgICAgICBlZGl0b3JDb21wb25lbnRzPXtmaWVsZC5nZXQoJ2VkaXRvcl9jb21wb25lbnRzJyl9XG4gICAgICAgICAgICAgIGhhc01hcms9e2hhc01hcmt9XG4gICAgICAgICAgICAgIGhhc0lubGluZT17aGFzSW5saW5lfVxuICAgICAgICAgICAgICBoYXNCbG9jaz17aGFzQmxvY2t9XG4gICAgICAgICAgICAgIGhhc1F1b3RlPXtoYXNRdW90ZX1cbiAgICAgICAgICAgICAgaGFzTGlzdEl0ZW1zPXtoYXNMaXN0SXRlbXN9XG4gICAgICAgICAgICAgIGlzU2hvd01vZGVUb2dnbGU9e2lzU2hvd01vZGVUb2dnbGV9XG4gICAgICAgICAgICAgIHQ9e3R9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc0Rpc2FibGVkfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICB9XG4gICAgICAgIDwvRWRpdG9yQ29udHJvbEJhcj5cbiAgICAgICAge1xuICAgICAgICAgIDxDbGFzc05hbWVzPlxuICAgICAgICAgICAgeyh7IGNzcywgY3ggfSkgPT4gKFxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjeChcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSxcbiAgICAgICAgICAgICAgICAgIGNzc2BcbiAgICAgICAgICAgICAgICAgICAgJHt2aXN1YWxFZGl0b3JTdHlsZXMoeyBtaW5pbWFsOiBmaWVsZC5nZXQoJ21pbmltYWwnKSB9KX1cbiAgICAgICAgICAgICAgICAgIGAsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtlZGl0b3JWYWx1ZS5sZW5ndGggIT09IDAgJiYgKFxuICAgICAgICAgICAgICAgICAgPEVkaXRhYmxlXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y3NzYFxuICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDE2cHggMjBweCAwO1xuICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgICByZW5kZXJFbGVtZW50PXtyZW5kZXJFbGVtZW50fVxuICAgICAgICAgICAgICAgICAgICByZW5kZXJMZWFmPXtyZW5kZXJMZWFmfVxuICAgICAgICAgICAgICAgICAgICBvbktleURvd249e2hhbmRsZUtleURvd259XG4gICAgICAgICAgICAgICAgICAgIGF1dG9Gb2N1cz17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPEluc2VydGlvblBvaW50IG9uQ2xpY2s9e2hhbmRsZUNsaWNrQmVsb3dEb2N1bWVudH0gLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvQ2xhc3NOYW1lcz5cbiAgICAgICAgfVxuICAgICAgPC9TbGF0ZT5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuRWRpdG9yLnByb3BUeXBlcyA9IHtcbiAgb25BZGRBc3NldDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZ2V0QXNzZXQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbk1vZGU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICB2YWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgZmllbGQ6IEltbXV0YWJsZVByb3BUeXBlcy5tYXAuaXNSZXF1aXJlZCxcbiAgZ2V0RWRpdG9yQ29tcG9uZW50czogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZ2V0UmVtYXJrUGx1Z2luczogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgaXNTaG93TW9kZVRvZ2dsZTogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEVkaXRvcjtcbiJdfQ== */",
  toString: _EMOTION_STRINGIFIED_CSS_ERROR__
});
export function mergeMediaConfig(editorComponents, field) {
  // merge editor media library config to image components
  if (editorComponents.has('image')) {
    const imageComponent = editorComponents.get('image');
    const fields = imageComponent === null || imageComponent === void 0 ? void 0 : imageComponent.fields;
    if (fields) {
      imageComponent.fields = fields.update(fields.findIndex(f => f.get('widget') === 'image'), f => {
        // merge `media_library` config
        if (field.has('media_library')) {
          f = f.set('media_library', field.get('media_library').mergeDeep(f.get('media_library')));
        }
        // merge 'media_folder'
        if (field.has('media_folder') && !f.has('media_folder')) {
          f = f.set('media_folder', field.get('media_folder'));
        }
        // merge 'public_folder'
        if (field.has('public_folder') && !f.has('public_folder')) {
          f = f.set('public_folder', field.get('public_folder'));
        }
        return f;
      });
    }
  }
}
var _ref = process.env.NODE_ENV === "production" ? {
  name: "j8ayvn-Editor",
  styles: "position:relative;label:Editor;"
} : {
  name: "j8ayvn-Editor",
  styles: "position:relative;label:Editor;",
  map: "/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9NYXJrZG93bkNvbnRyb2wvVmlzdWFsRWRpdG9yLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQTROa0IiLCJmaWxlIjoiLi4vLi4vLi4vc3JjL01hcmtkb3duQ29udHJvbC9WaXN1YWxFZGl0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAcmVmcmVzaCByZXNldFxuaW1wb3J0IFJlYWN0LCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZU1lbW8sIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBJbW11dGFibGVQcm9wVHlwZXMgZnJvbSAncmVhY3QtaW1tdXRhYmxlLXByb3B0eXBlcyc7XG5pbXBvcnQgeyBDbGFzc05hbWVzLCBjc3MgYXMgY29yZUNzcyB9IGZyb20gJ0BlbW90aW9uL3JlYWN0JztcbmltcG9ydCB7IGxlbmd0aHMsIGZvbnRzLCB6SW5kZXggfSBmcm9tICdkZWNhcC1jbXMtdWktZGVmYXVsdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBjcmVhdGVFZGl0b3IsIFRyYW5zZm9ybXMsIEVkaXRvciBhcyBTbGF0ZUVkaXRvciB9IGZyb20gJ3NsYXRlJztcbmltcG9ydCB7IEVkaXRhYmxlLCBSZWFjdEVkaXRvciwgU2xhdGUsIHdpdGhSZWFjdCB9IGZyb20gJ3NsYXRlLXJlYWN0JztcbmltcG9ydCB7IHdpdGhIaXN0b3J5IH0gZnJvbSAnc2xhdGUtaGlzdG9yeSc7XG5pbXBvcnQgeyBmcm9tSlMgfSBmcm9tICdpbW11dGFibGUnO1xuaW1wb3J0IHsgaXNFcXVhbCB9IGZyb20gJ2xvZGFzaCc7XG5cbmltcG9ydCB7IGVkaXRvclN0eWxlVmFycywgRWRpdG9yQ29udHJvbEJhciB9IGZyb20gJy4uL3N0eWxlcyc7XG5pbXBvcnQgVG9vbGJhciBmcm9tICcuL1Rvb2xiYXInO1xuaW1wb3J0IHsgRWxlbWVudCwgTGVhZiB9IGZyb20gJy4vcmVuZGVyZXJzJztcbmltcG9ydCB3aXRoTGlzdHMgZnJvbSAnLi9wbHVnaW5zL2xpc3RzL3dpdGhMaXN0cyc7XG5pbXBvcnQgd2l0aEJsb2NrcyBmcm9tICcuL3BsdWdpbnMvYmxvY2tzL3dpdGhCbG9ja3MnO1xuaW1wb3J0IHdpdGhJbmxpbmVzIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL3dpdGhJbmxpbmVzJztcbmltcG9ydCB0b2dnbGVNYXJrIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL2V2ZW50cy90b2dnbGVNYXJrJztcbmltcG9ydCB0b2dnbGVMaW5rIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL2V2ZW50cy90b2dnbGVMaW5rJztcbmltcG9ydCBnZXRBY3RpdmVMaW5rIGZyb20gJy4vcGx1Z2lucy9pbmxpbmVzL3NlbGVjdG9ycy9nZXRBY3RpdmVMaW5rJztcbmltcG9ydCBpc01hcmtBY3RpdmUgZnJvbSAnLi9wbHVnaW5zL2lubGluZXMvbG9jYXRpb25zL2lzTWFya0FjdGl2ZSc7XG5pbXBvcnQgaXNDdXJzb3JJbkJsb2NrVHlwZSBmcm9tICcuL3BsdWdpbnMvYmxvY2tzL2xvY2F0aW9ucy9pc0N1cnNvckluQmxvY2tUeXBlJztcbmltcG9ydCB7IG1hcmtkb3duVG9TbGF0ZSwgc2xhdGVUb01hcmtkb3duIH0gZnJvbSAnLi4vc2VyaWFsaXplcnMnO1xuaW1wb3J0IHdpdGhTaG9ydGNvZGVzIGZyb20gJy4vcGx1Z2lucy9zaG9ydGNvZGVzL3dpdGhTaG9ydGNvZGVzJztcbmltcG9ydCBpbnNlcnRTaG9ydGNvZGUgZnJvbSAnLi9wbHVnaW5zL3Nob3J0Y29kZXMvaW5zZXJ0U2hvcnRjb2RlJztcbmltcG9ydCBkZWZhdWx0RW1wdHlCbG9jayBmcm9tICcuL3BsdWdpbnMvYmxvY2tzL2RlZmF1bHRFbXB0eUJsb2NrJztcbmltcG9ydCB3aXRoSHRtbCBmcm9tICcuL3BsdWdpbnMvaHRtbC93aXRoSHRtbCc7XG5cbmZ1bmN0aW9uIHZpc3VhbEVkaXRvclN0eWxlcyh7IG1pbmltYWwgfSkge1xuICByZXR1cm4gYFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIG92ZXJmbG93OiBhdXRvO1xuICBmb250LWZhbWlseTogJHtmb250cy5wcmltYXJ5fTtcbiAgbWluLWhlaWdodDogJHttaW5pbWFsID8gJ2F1dG8nIDogbGVuZ3Rocy5yaWNoVGV4dEVkaXRvck1pbkhlaWdodH07XG4gIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDA7XG4gIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAwO1xuICBib3JkZXItdG9wOiAwO1xuICBtYXJnaW4tdG9wOiAtJHtlZGl0b3JTdHlsZVZhcnMuc3RpY2t5RGlzdGFuY2VCb3R0b219O1xuICBwYWRkaW5nOiAwO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICB6LWluZGV4OiAke3pJbmRleC56SW5kZXgxMDB9O1xuYDtcbn1cblxuY29uc3QgSW5zZXJ0aW9uUG9pbnQgPSBzdHlsZWQuZGl2YFxuICBmbGV4OiAxIDEgYXV0bztcbiAgY3Vyc29yOiB0ZXh0O1xuYDtcblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlTWVkaWFDb25maWcoZWRpdG9yQ29tcG9uZW50cywgZmllbGQpIHtcbiAgLy8gbWVyZ2UgZWRpdG9yIG1lZGlhIGxpYnJhcnkgY29uZmlnIHRvIGltYWdlIGNvbXBvbmVudHNcbiAgaWYgKGVkaXRvckNvbXBvbmVudHMuaGFzKCdpbWFnZScpKSB7XG4gICAgY29uc3QgaW1hZ2VDb21wb25lbnQgPSBlZGl0b3JDb21wb25lbnRzLmdldCgnaW1hZ2UnKTtcbiAgICBjb25zdCBmaWVsZHMgPSBpbWFnZUNvbXBvbmVudD8uZmllbGRzO1xuXG4gICAgaWYgKGZpZWxkcykge1xuICAgICAgaW1hZ2VDb21wb25lbnQuZmllbGRzID0gZmllbGRzLnVwZGF0ZShcbiAgICAgICAgZmllbGRzLmZpbmRJbmRleChmID0+IGYuZ2V0KCd3aWRnZXQnKSA9PT0gJ2ltYWdlJyksXG4gICAgICAgIGYgPT4ge1xuICAgICAgICAgIC8vIG1lcmdlIGBtZWRpYV9saWJyYXJ5YCBjb25maWdcbiAgICAgICAgICBpZiAoZmllbGQuaGFzKCdtZWRpYV9saWJyYXJ5JykpIHtcbiAgICAgICAgICAgIGYgPSBmLnNldChcbiAgICAgICAgICAgICAgJ21lZGlhX2xpYnJhcnknLFxuICAgICAgICAgICAgICBmaWVsZC5nZXQoJ21lZGlhX2xpYnJhcnknKS5tZXJnZURlZXAoZi5nZXQoJ21lZGlhX2xpYnJhcnknKSksXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBtZXJnZSAnbWVkaWFfZm9sZGVyJ1xuICAgICAgICAgIGlmIChmaWVsZC5oYXMoJ21lZGlhX2ZvbGRlcicpICYmICFmLmhhcygnbWVkaWFfZm9sZGVyJykpIHtcbiAgICAgICAgICAgIGYgPSBmLnNldCgnbWVkaWFfZm9sZGVyJywgZmllbGQuZ2V0KCdtZWRpYV9mb2xkZXInKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIG1lcmdlICdwdWJsaWNfZm9sZGVyJ1xuICAgICAgICAgIGlmIChmaWVsZC5oYXMoJ3B1YmxpY19mb2xkZXInKSAmJiAhZi5oYXMoJ3B1YmxpY19mb2xkZXInKSkge1xuICAgICAgICAgICAgZiA9IGYuc2V0KCdwdWJsaWNfZm9sZGVyJywgZmllbGQuZ2V0KCdwdWJsaWNfZm9sZGVyJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZjtcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIEVkaXRvcihwcm9wcykge1xuICBjb25zdCB7XG4gICAgb25BZGRBc3NldCxcbiAgICBnZXRBc3NldCxcbiAgICBjbGFzc05hbWUsXG4gICAgZmllbGQsXG4gICAgaXNTaG93TW9kZVRvZ2dsZSxcbiAgICB0LFxuICAgIGlzRGlzYWJsZWQsXG4gICAgZ2V0RWRpdG9yQ29tcG9uZW50cyxcbiAgICBnZXRSZW1hcmtQbHVnaW5zLFxuICAgIG9uQ2hhbmdlLFxuICB9ID0gcHJvcHM7XG5cbiAgY29uc3QgZWRpdG9yID0gdXNlTWVtbyhcbiAgICAoKSA9PlxuICAgICAgd2l0aEh0bWwoXG4gICAgICAgIHdpdGhSZWFjdCh3aXRoSGlzdG9yeSh3aXRoU2hvcnRjb2Rlcyh3aXRoQmxvY2tzKHdpdGhMaXN0cyh3aXRoSW5saW5lcyhjcmVhdGVFZGl0b3IoKSkpKSkpKSxcbiAgICAgICksXG4gICAgW10sXG4gICk7XG5cbiAgY29uc3QgZW1wdHlWYWx1ZSA9IFtkZWZhdWx0RW1wdHlCbG9jaygpXTtcbiAgbGV0IGVkaXRvckNvbXBvbmVudHMgPSBnZXRFZGl0b3JDb21wb25lbnRzKCk7XG4gIGNvbnN0IGNvZGVCbG9ja0NvbXBvbmVudCA9IGZyb21KUyhlZGl0b3JDb21wb25lbnRzLmZpbmQoKHsgdHlwZSB9KSA9PiB0eXBlID09PSAnY29kZS1ibG9jaycpKTtcblxuICBlZGl0b3JDb21wb25lbnRzID1cbiAgICBjb2RlQmxvY2tDb21wb25lbnQgfHwgZWRpdG9yQ29tcG9uZW50cy5oYXMoJ2NvZGUtYmxvY2snKVxuICAgICAgPyBlZGl0b3JDb21wb25lbnRzXG4gICAgICA6IGVkaXRvckNvbXBvbmVudHMuc2V0KCdjb2RlLWJsb2NrJywgeyBsYWJlbDogJ0NvZGUgQmxvY2snLCB0eXBlOiAnY29kZS1ibG9jaycgfSk7XG5cbiAgbWVyZ2VNZWRpYUNvbmZpZyhlZGl0b3JDb21wb25lbnRzLCBmaWVsZCk7XG5cbiAgY29uc3QgW2VkaXRvclZhbHVlLCBzZXRFZGl0b3JWYWx1ZV0gPSB1c2VTdGF0ZShcbiAgICBwcm9wcy52YWx1ZVxuICAgICAgPyBtYXJrZG93blRvU2xhdGUocHJvcHMudmFsdWUsIHtcbiAgICAgICAgICB2b2lkQ29kZUJsb2NrOiAhIWNvZGVCbG9ja0NvbXBvbmVudCxcbiAgICAgICAgICByZW1hcmtQbHVnaW5zOiBnZXRSZW1hcmtQbHVnaW5zKCksXG4gICAgICAgIH0pXG4gICAgICA6IGVtcHR5VmFsdWUsXG4gICk7XG5cbiAgY29uc3QgcmVuZGVyRWxlbWVudCA9IHVzZUNhbGxiYWNrKFxuICAgIHByb3BzID0+IChcbiAgICAgIDxFbGVtZW50IHsuLi5wcm9wc30gY2xhc3NOYW1lV3JhcHBlcj17Y2xhc3NOYW1lfSBjb2RlQmxvY2tDb21wb25lbnQ9e2NvZGVCbG9ja0NvbXBvbmVudH0gLz5cbiAgICApLFxuICAgIFtdLFxuICApO1xuICBjb25zdCByZW5kZXJMZWFmID0gdXNlQ2FsbGJhY2socHJvcHMgPT4gPExlYWYgey4uLnByb3BzfSAvPiwgW10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHByb3BzLnBlbmRpbmdGb2N1cykge1xuICAgICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgICAgIHByb3BzLnBlbmRpbmdGb2N1cygpO1xuICAgIH1cbiAgfSwgW3Byb3BzLnBlbmRpbmdGb2N1c10pO1xuXG4gIGZ1bmN0aW9uIGhhbmRsZU1hcmtDbGljayhmb3JtYXQpIHtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICAgIHRvZ2dsZU1hcmsoZWRpdG9yLCBmb3JtYXQpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlQmxvY2tDbGljayhmb3JtYXQpIHtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICAgIGlmIChmb3JtYXQuZW5kc1dpdGgoJy1saXN0JykpIHtcbiAgICAgIGVkaXRvci50b2dnbGVMaXN0KGZvcm1hdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVkaXRvci50b2dnbGVCbG9jayhmb3JtYXQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUxpbmtDbGljaygpIHtcbiAgICB0b2dnbGVMaW5rKGVkaXRvciwgdCgnZWRpdG9yLmVkaXRvcldpZGdldHMubWFya2Rvd24ubGlua1Byb21wdCcpKTtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlVG9nZ2xlTW9kZSgpIHtcbiAgICBwcm9wcy5vbk1vZGUoJ3JhdycpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlSW5zZXJ0U2hvcnRjb2RlKHBsdWdpbkNvbmZpZykge1xuICAgIGluc2VydFNob3J0Y29kZShlZGl0b3IsIHBsdWdpbkNvbmZpZyk7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVLZXlEb3duKGV2ZW50KSB7XG4gICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGVkaXRvci5rZXlEb3duSGFuZGxlcnMgfHwgW10pIHtcbiAgICAgIGlmIChoYW5kbGVyKGV2ZW50LCBlZGl0b3IpID09PSBmYWxzZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgUmVhY3RFZGl0b3IuZm9jdXMoZWRpdG9yKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUNsaWNrQmVsb3dEb2N1bWVudCgpIHtcbiAgICBSZWFjdEVkaXRvci5mb2N1cyhlZGl0b3IpO1xuICAgIFRyYW5zZm9ybXMuc2VsZWN0KGVkaXRvciwgeyBwYXRoOiBbMCwgMF0sIG9mZnNldDogMCB9KTtcbiAgICBUcmFuc2Zvcm1zLnNlbGVjdChlZGl0b3IsIFNsYXRlRWRpdG9yLmVuZChlZGl0b3IsIFtdKSk7XG4gIH1cbiAgY29uc3QgW3Rvb2xiYXJLZXksIHNldFRvb2xiYXJLZXldID0gdXNlU3RhdGUoMCk7XG5cbiAgZnVuY3Rpb24gaGFuZGxlQ2hhbmdlKG5ld1ZhbHVlKSB7XG4gICAgaWYgKCFpc0VxdWFsKG5ld1ZhbHVlLCBlZGl0b3JWYWx1ZSkpIHtcbiAgICAgIHNldEVkaXRvclZhbHVlKCgpID0+IG5ld1ZhbHVlKTtcbiAgICAgIG9uQ2hhbmdlKFxuICAgICAgICBzbGF0ZVRvTWFya2Rvd24obmV3VmFsdWUsIHtcbiAgICAgICAgICB2b2lkQ29kZUJsb2NrOiAhIWNvZGVCbG9ja0NvbXBvbmVudCxcbiAgICAgICAgICByZW1hcmtQbHVnaW5zOiBnZXRSZW1hcmtQbHVnaW5zKCksXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9XG4gICAgc2V0VG9vbGJhcktleShwcmV2ID0+IHByZXYgKyAxKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhc01hcmsoZm9ybWF0KSB7XG4gICAgcmV0dXJuIGlzTWFya0FjdGl2ZShlZGl0b3IsIGZvcm1hdCk7XG4gIH1cblxuICBmdW5jdGlvbiBoYXNJbmxpbmUoZm9ybWF0KSB7XG4gICAgaWYgKGZvcm1hdCA9PSAnbGluaycpIHtcbiAgICAgIHJldHVybiAhIWdldEFjdGl2ZUxpbmsoZWRpdG9yKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFzQmxvY2soZm9ybWF0KSB7XG4gICAgcmV0dXJuIGlzQ3Vyc29ySW5CbG9ja1R5cGUoZWRpdG9yLCBmb3JtYXQpO1xuICB9XG4gIGZ1bmN0aW9uIGhhc1F1b3RlKCkge1xuICAgIHJldHVybiBpc0N1cnNvckluQmxvY2tUeXBlKGVkaXRvciwgJ3F1b3RlJyk7XG4gIH1cbiAgZnVuY3Rpb24gaGFzTGlzdEl0ZW1zKHR5cGUpIHtcbiAgICByZXR1cm4gaXNDdXJzb3JJbkJsb2NrVHlwZShlZGl0b3IsIHR5cGUpO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjc3M9e2NvcmVDc3NgXG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIGB9XG4gICAgPlxuICAgICAgPFNsYXRlIGVkaXRvcj17ZWRpdG9yfSB2YWx1ZT17ZWRpdG9yVmFsdWV9IG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9PlxuICAgICAgICA8RWRpdG9yQ29udHJvbEJhcj5cbiAgICAgICAgICB7XG4gICAgICAgICAgICA8VG9vbGJhclxuICAgICAgICAgICAgICBrZXk9e3Rvb2xiYXJLZXl9XG4gICAgICAgICAgICAgIG9uTWFya0NsaWNrPXtoYW5kbGVNYXJrQ2xpY2t9XG4gICAgICAgICAgICAgIG9uQmxvY2tDbGljaz17aGFuZGxlQmxvY2tDbGlja31cbiAgICAgICAgICAgICAgb25MaW5rQ2xpY2s9e2hhbmRsZUxpbmtDbGlja31cbiAgICAgICAgICAgICAgb25Ub2dnbGVNb2RlPXtoYW5kbGVUb2dnbGVNb2RlfVxuICAgICAgICAgICAgICBwbHVnaW5zPXtlZGl0b3JDb21wb25lbnRzfVxuICAgICAgICAgICAgICBvblN1Ym1pdD17aGFuZGxlSW5zZXJ0U2hvcnRjb2RlfVxuICAgICAgICAgICAgICBvbkFkZEFzc2V0PXtvbkFkZEFzc2V0fVxuICAgICAgICAgICAgICBnZXRBc3NldD17Z2V0QXNzZXR9XG4gICAgICAgICAgICAgIGJ1dHRvbnM9e2ZpZWxkLmdldCgnYnV0dG9ucycpfVxuICAgICAgICAgICAgICBlZGl0b3JDb21wb25lbnRzPXtmaWVsZC5nZXQoJ2VkaXRvcl9jb21wb25lbnRzJyl9XG4gICAgICAgICAgICAgIGhhc01hcms9e2hhc01hcmt9XG4gICAgICAgICAgICAgIGhhc0lubGluZT17aGFzSW5saW5lfVxuICAgICAgICAgICAgICBoYXNCbG9jaz17aGFzQmxvY2t9XG4gICAgICAgICAgICAgIGhhc1F1b3RlPXtoYXNRdW90ZX1cbiAgICAgICAgICAgICAgaGFzTGlzdEl0ZW1zPXtoYXNMaXN0SXRlbXN9XG4gICAgICAgICAgICAgIGlzU2hvd01vZGVUb2dnbGU9e2lzU2hvd01vZGVUb2dnbGV9XG4gICAgICAgICAgICAgIHQ9e3R9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc0Rpc2FibGVkfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICB9XG4gICAgICAgIDwvRWRpdG9yQ29udHJvbEJhcj5cbiAgICAgICAge1xuICAgICAgICAgIDxDbGFzc05hbWVzPlxuICAgICAgICAgICAgeyh7IGNzcywgY3ggfSkgPT4gKFxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjeChcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSxcbiAgICAgICAgICAgICAgICAgIGNzc2BcbiAgICAgICAgICAgICAgICAgICAgJHt2aXN1YWxFZGl0b3JTdHlsZXMoeyBtaW5pbWFsOiBmaWVsZC5nZXQoJ21pbmltYWwnKSB9KX1cbiAgICAgICAgICAgICAgICAgIGAsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtlZGl0b3JWYWx1ZS5sZW5ndGggIT09IDAgJiYgKFxuICAgICAgICAgICAgICAgICAgPEVkaXRhYmxlXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y3NzYFxuICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDE2cHggMjBweCAwO1xuICAgICAgICAgICAgICAgICAgICBgfVxuICAgICAgICAgICAgICAgICAgICByZW5kZXJFbGVtZW50PXtyZW5kZXJFbGVtZW50fVxuICAgICAgICAgICAgICAgICAgICByZW5kZXJMZWFmPXtyZW5kZXJMZWFmfVxuICAgICAgICAgICAgICAgICAgICBvbktleURvd249e2hhbmRsZUtleURvd259XG4gICAgICAgICAgICAgICAgICAgIGF1dG9Gb2N1cz17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPEluc2VydGlvblBvaW50IG9uQ2xpY2s9e2hhbmRsZUNsaWNrQmVsb3dEb2N1bWVudH0gLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvQ2xhc3NOYW1lcz5cbiAgICAgICAgfVxuICAgICAgPC9TbGF0ZT5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuRWRpdG9yLnByb3BUeXBlcyA9IHtcbiAgb25BZGRBc3NldDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZ2V0QXNzZXQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbk1vZGU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICB2YWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgZmllbGQ6IEltbXV0YWJsZVByb3BUeXBlcy5tYXAuaXNSZXF1aXJlZCxcbiAgZ2V0RWRpdG9yQ29tcG9uZW50czogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgZ2V0UmVtYXJrUGx1Z2luczogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgaXNTaG93TW9kZVRvZ2dsZTogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEVkaXRvcjtcbiJdfQ== */",
  toString: _EMOTION_STRINGIFIED_CSS_ERROR__
};
function Editor(props) {
  const {
    onAddAsset,
    getAsset,
    className,
    field,
    isShowModeToggle,
    t,
    isDisabled,
    getEditorComponents,
    getRemarkPlugins,
    onChange
  } = props;
  const editor = useMemo(() => withHtml(withReact(withHistory(withShortcodes(withBlocks(withLists(withInlines(createEditor()))))))), []);
  const emptyValue = [defaultEmptyBlock()];
  let editorComponents = getEditorComponents();
  const codeBlockComponent = fromJS(editorComponents.find(({
    type
  }) => type === 'code-block'));
  editorComponents = codeBlockComponent || editorComponents.has('code-block') ? editorComponents : editorComponents.set('code-block', {
    label: 'Code Block',
    type: 'code-block'
  });
  mergeMediaConfig(editorComponents, field);
  const [editorValue, setEditorValue] = useState(props.value ? markdownToSlate(props.value, {
    voidCodeBlock: !!codeBlockComponent,
    remarkPlugins: getRemarkPlugins()
  }) : emptyValue);
  const renderElement = useCallback(props => ___EmotionJSX(Element, _extends({}, props, {
    classNameWrapper: className,
    codeBlockComponent: codeBlockComponent
  })), []);
  const renderLeaf = useCallback(props => ___EmotionJSX(Leaf, props), []);
  useEffect(() => {
    if (props.pendingFocus) {
      ReactEditor.focus(editor);
      props.pendingFocus();
    }
  }, [props.pendingFocus]);
  function handleMarkClick(format) {
    ReactEditor.focus(editor);
    toggleMark(editor, format);
  }
  function handleBlockClick(format) {
    ReactEditor.focus(editor);
    if (format.endsWith('-list')) {
      editor.toggleList(format);
    } else {
      editor.toggleBlock(format);
    }
  }
  function handleLinkClick() {
    toggleLink(editor, t('editor.editorWidgets.markdown.linkPrompt'));
    ReactEditor.focus(editor);
  }
  function handleToggleMode() {
    props.onMode('raw');
  }
  function handleInsertShortcode(pluginConfig) {
    insertShortcode(editor, pluginConfig);
  }
  function handleKeyDown(event) {
    for (const handler of editor.keyDownHandlers || []) {
      if (handler(event, editor) === false) {
        break;
      }
    }
    ReactEditor.focus(editor);
  }
  function handleClickBelowDocument() {
    ReactEditor.focus(editor);
    Transforms.select(editor, {
      path: [0, 0],
      offset: 0
    });
    Transforms.select(editor, SlateEditor.end(editor, []));
  }
  const [toolbarKey, setToolbarKey] = useState(0);
  function handleChange(newValue) {
    if (!_isEqual(newValue, editorValue)) {
      setEditorValue(() => newValue);
      onChange(slateToMarkdown(newValue, {
        voidCodeBlock: !!codeBlockComponent,
        remarkPlugins: getRemarkPlugins()
      }));
    }
    setToolbarKey(prev => prev + 1);
  }
  function hasMark(format) {
    return isMarkActive(editor, format);
  }
  function hasInline(format) {
    if (format == 'link') {
      return !!getActiveLink(editor);
    }
    return false;
  }
  function hasBlock(format) {
    return isCursorInBlockType(editor, format);
  }
  function hasQuote() {
    return isCursorInBlockType(editor, 'quote');
  }
  function hasListItems(type) {
    return isCursorInBlockType(editor, type);
  }
  return ___EmotionJSX("div", {
    css: _ref
  }, ___EmotionJSX(Slate, {
    editor: editor,
    value: editorValue,
    onChange: handleChange
  }, ___EmotionJSX(EditorControlBar, null, ___EmotionJSX(Toolbar, {
    key: toolbarKey,
    onMarkClick: handleMarkClick,
    onBlockClick: handleBlockClick,
    onLinkClick: handleLinkClick,
    onToggleMode: handleToggleMode,
    plugins: editorComponents,
    onSubmit: handleInsertShortcode,
    onAddAsset: onAddAsset,
    getAsset: getAsset,
    buttons: field.get('buttons'),
    editorComponents: field.get('editor_components'),
    hasMark: hasMark,
    hasInline: hasInline,
    hasBlock: hasBlock,
    hasQuote: hasQuote,
    hasListItems: hasListItems,
    isShowModeToggle: isShowModeToggle,
    t: t,
    disabled: isDisabled
  })), ___EmotionJSX(ClassNames, null, ({
    css,
    cx
  }) => ___EmotionJSX("div", {
    className: cx(className, css`
                    ${visualEditorStyles({
      minimal: field.get('minimal')
    })}
                  `)
  }, editorValue.length !== 0 && ___EmotionJSX(Editable, {
    className: css`
                      padding: 16px 20px 0;
                    `,
    renderElement: renderElement,
    renderLeaf: renderLeaf,
    onKeyDown: handleKeyDown,
    autoFocus: false
  }), ___EmotionJSX(InsertionPoint, {
    onClick: handleClickBelowDocument
  })))));
}
Editor.propTypes = {
  onAddAsset: PropTypes.func.isRequired,
  getAsset: PropTypes.func.isRequired,
  onChange: PropTypes.func.isRequired,
  onMode: PropTypes.func.isRequired,
  className: PropTypes.string.isRequired,
  value: PropTypes.string,
  field: ImmutablePropTypes.map.isRequired,
  getEditorComponents: PropTypes.func.isRequired,
  getRemarkPlugins: PropTypes.func.isRequired,
  isShowModeToggle: PropTypes.bool.isRequired,
  t: PropTypes.func.isRequired
};
export default Editor;